{% extends "layout.html" %}

{% block content %}
<div class="d-flex justify-content-center align-items-center" style="min-height: 80vh;">
  <div class="card bg-dark text-white p-4 shadow" style="max-width: 400px; width: 100%;">
    <div class="card-body">
      <h2 class="card-title text-center mb-4">
        <i class="bi bi-person-plus me-2"></i>Cadastro Cliente
      </h2>
      <p class="text-center text-muted mb-4">
        <small>Crie sua conta e comece a treinar!</small>
      </p>

      <!-- Exibir todos os erros no topo -->
      {% if erros %}
      <div class="alert alert-danger" role="alert">
        <strong><i class="bi bi-exclamation-triangle-fill me-2"></i>Corrija os seguintes erros:</strong>
        <ul class="mb-0 mt-2">
          {% for campo, msg in erros.items() %}
          <li><strong>{{ campo.capitalize() }}:</strong> {{ msg }}</li>
          {% endfor %}
        </ul>
      </div>
      {% endif %}

      <!-- Erro geral (caso exista) -->
      {% if erro %}
      <div class="alert alert-danger" role="alert">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>{{ erro }}
      </div>
      {% endif %}

      <form method="POST" action="/cadastro_cliente" id="form-cadastro">
        <!-- Nome -->
        <div class="mb-3">
          <label for="nome" class="form-label">Nome Completo *</label>
          <input 
            type="text" 
            class="form-control bg-secondary text-white border-0 {% if erros and 'nome' in erros %}is-invalid{% endif %}" 
            id="nome" 
            name="nome"
            value="{{ dados.nome if dados else '' }}" 
            required
            minlength="3"
            maxlength="100"
            placeholder="Digite seu nome completo"
          >
          {% if erros and 'nome' in erros %}
          <div class="invalid-feedback d-block">
            <i class="bi bi-x-circle me-1"></i>{{ erros['nome'] }}
          </div>
          {% endif %}
        </div>

        <!-- Email -->
        <div class="mb-3">
          <label for="email" class="form-label">Email *</label>
          <input 
            type="email" 
            class="form-control bg-secondary text-white border-0 {% if erros and 'email' in erros %}is-invalid{% endif %}" 
            id="email" 
            name="email"
            value="{{ dados.email if dados else '' }}" 
            required
            placeholder="seu@email.com"
          >
          {% if erros and 'email' in erros %}
          <div class="invalid-feedback d-block">
            <i class="bi bi-x-circle me-1"></i>{{ erros['email'] }}
          </div>
          {% endif %}
        </div>

        <!-- Senha -->
        <div class="mb-3">
          <label for="senha" class="form-label">Senha *</label>
          <input 
            type="password" 
            class="form-control bg-secondary text-white border-0 {% if erros and 'senha' in erros %}is-invalid{% endif %}" 
            id="senha" 
            name="senha" 
            required
            minlength="6"
            maxlength="50"
            placeholder="Mínimo 6 caracteres"
          >
          <div class="form-text text-muted">
            <small>A senha deve ter entre 6 e 50 caracteres (sem espaços)</small>
          </div>
          {% if erros and 'senha' in erros %}
          <div class="invalid-feedback d-block">
            <i class="bi bi-x-circle me-1"></i>{{ erros['senha'] }}
          </div>
          {% endif %}
        </div>

        <!-- Repetir Senha -->
        <div class="mb-3">
          <label for="senha_confirm" class="form-label">Repetir Senha *</label>
          <input 
            type="password" 
            class="form-control bg-secondary text-white border-0 {% if erros and 'senha_confirm' in erros %}is-invalid{% endif %}" 
            id="senha_confirm" 
            name="senha_confirm" 
            required
            minlength="6"
            maxlength="50"
            placeholder="Digite novamente sua senha"
          >
          {% if erros and 'senha_confirm' in erros %}
          <div class="invalid-feedback d-block">
            <i class="bi bi-x-circle me-1"></i>{{ erros['senha_confirm'] }}
          </div>
          {% endif %}
        </div>

        <!-- Termos de Uso -->
        <div class="form-check mb-3">
          <input class="form-check-input" type="checkbox" id="aceito_termos" required>
          <label class="form-check-label" for="aceito_termos">
            <small>
              Li e aceito os <a href="#" class="text-info">Termos de Uso</a> e 
              <a href="#" class="text-info">Política de Privacidade</a> *
            </small>
          </label>
        </div>

        <button type="submit" class="btn btn-primary w-100" id="btn-cadastrar">
          <i class="bi bi-check-circle me-2"></i>Criar Conta
        </button>
      </form>

      <p class="text-center mt-3 mb-0">
        Já tem conta?
        <a href="/login_cliente" class="text-info text-decoration-none fw-bold">Faça login</a>
      </p>

      <hr class="my-3 bg-secondary">

      <p class="text-center mb-0">
        <small class="text-muted">
          É profissional? 
          <a href="/cadastro_profissional" class="text-warning">Cadastre-se aqui</a>
        </small>
      </p>
    </div>
  </div>
</div>

<script>
  // Desabilitar botão durante envio
  document.getElementById('form-cadastro').addEventListener('submit', function(e) {
      const btn = document.getElementById('btn-cadastrar');
      btn.disabled = true;
      btn.innerHTML = '<i class="bi bi-hourglass-split me-2"></i>Criando conta...';
  });
</script>
{% endblock %}