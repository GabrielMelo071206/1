{% extends "layout.html" %}

{% block content %}
<div class="d-flex justify-content-center align-items-center" style="min-height: 80vh;">
  <div class="card bg-dark text-white p-4 shadow" style="max-width: 400px; width: 100%;">
    <div class="card-body">
      <h2 class="card-title text-center mb-4">
        <i class="bi bi-person-plus me-2"></i>Cadastro Cliente
      </h2>
      
      <p class="text-center text-muted mb-4">
        <small>Crie sua conta e comece a treinar!</small>
      </p>

      {% if erro %}
      <div class="alert alert-danger" role="alert">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>{{ erro }}
      </div>
      {% endif %}

      <form method="POST" action="/cadastro_cliente" id="form-cadastro">
        <!-- Nome -->
        <div class="mb-3">
          <label for="nome" class="form-label">Nome Completo *</label>
          <input 
            type="text" 
            class="form-control bg-secondary text-white border-0 {% if erro and 'nome' in erro.lower() %}is-invalid{% endif %}" 
            id="nome" 
            name="nome"
            value="{{ dados.nome if dados else '' }}" 
            required
            minlength="3"
            maxlength="100"
            placeholder="Digite seu nome completo"
          >
          {% if erro and 'nome' in erro.lower() %}
          <div class="invalid-feedback">{{ erro }}</div>
          {% endif %}
        </div>

        <!-- Email -->
        <div class="mb-3">
          <label for="email" class="form-label">Email *</label>
          <input 
            type="email" 
            class="form-control bg-secondary text-white border-0 {% if erro and 'email' in erro.lower() %}is-invalid{% endif %}" 
            id="email" 
            name="email"
            value="{{ dados.email if dados else '' }}" 
            required
            placeholder="seu@email.com"
          >
          {% if erro and 'email' in erro.lower() %}
          <div class="invalid-feedback">{{ erro }}</div>
          {% endif %}
        </div>

        <!-- Senha -->
        <div class="mb-3">
          <label for="senha" class="form-label">Senha *</label>
          <input 
            type="password" 
            class="form-control bg-secondary text-white border-0 {% if erro and 'senha' in erro.lower() %}is-invalid{% endif %}" 
            id="senha" 
            name="senha" 
            required
            minlength="6"
            maxlength="50"
            placeholder="Mínimo 6 caracteres"
          >
          <div class="form-text text-muted">
            <small>A senha deve ter entre 6 e 50 caracteres</small>
          </div>
          {% if erro and 'senha' in erro.lower() %}
          <div class="invalid-feedback">{{ erro }}</div>
          {% endif %}
        </div>

        <!-- Repetir Senha -->
        <div class="mb-3">
          <label for="senha_confirm" class="form-label">Repetir Senha *</label>
          <input 
            type="password" 
            class="form-control bg-secondary text-white border-0" 
            id="senha_confirm" 
            name="senha_confirm" 
            required
            minlength="6"
            maxlength="50"
            placeholder="Digite novamente sua senha"
          >
          <div class="invalid-feedback" id="senhaConfirmErro" style="display: none;">
            As senhas não coincidem
          </div>
        </div>

        <!-- Termos de Uso -->
        <div class="form-check mb-3">
          <input class="form-check-input" type="checkbox" id="aceito_termos" required>
          <label class="form-check-label" for="aceito_termos">
            <small>
              Li e aceito os <a href="#" class="text-info">Termos de Uso</a> e 
              <a href="#" class="text-info">Política de Privacidade</a> *
            </small>
          </label>
        </div>

        <button type="submit" class="btn btn-primary w-100" id="btn-cadastrar">
          <i class="bi bi-check-circle me-2"></i>Criar Conta
        </button>
      </form>

      <p class="text-center mt-3 mb-0">
        Já tem conta?
        <a href="/login_cliente" class="text-info text-decoration-none fw-bold">Faça login</a>
      </p>
      
      <hr class="my-3 bg-secondary">
      
      <p class="text-center mb-0">
        <small class="text-muted">
          É profissional? 
          <a href="/cadastro_profissional" class="text-warning">Cadastre-se aqui</a>
        </small>
      </p>
    </div>
  </div>
</div>

<script>
// Desabilitar botão durante envio
document.getElementById('form-cadastro').addEventListener('submit', function(e) {
    const btn = document.getElementById('btn-cadastrar');
    btn.disabled = true;
    btn.innerHTML = '<i class="bi bi-hourglass-split me-2"></i>Criando conta...';
});

// Validação em tempo real
document.getElementById('nome').addEventListener('blur', function() {
    if (this.value.trim().length < 3) {
        this.classList.add('is-invalid');
    } else {
        this.classList.remove('is-invalid');
    }
});

document.getElementById('senha').addEventListener('input', function() {
    const senhaValida = this.value.length >= 6 && this.value.length <= 50;
    if (!senhaValida && this.value.length > 0) {
        this.classList.add('is-invalid');
    } else {
        this.classList.remove('is-invalid');
    }
});

// Validar se senhas coincidem
document.getElementById('form-cadastro').addEventListener('submit', function(e) {
    const senha = document.getElementById('senha').value;
    const senhaConfirm = document.getElementById('senha_confirm').value;

    if (senha !== senhaConfirm) {
        e.preventDefault();
        const erroDiv = document.getElementById('senhaConfirmErro');
        erroDiv.style.display = 'block';
        document.getElementById('senha_confirm').classList.add('is-invalid');
        return;
    } else {
        document.getElementById('senhaConfirmErro').style.display = 'none';
        document.getElementById('senha_confirm').classList.remove('is-invalid');
    }
});
</script>
{% endblock %}
